@use "variables";

.moon-tooltip {
  position: relative;
  display: inline-block;
  --tt-bg: var(--tooltip-background);
  --tt-off: calc(100% + var(--dimension-space-8));
  --tt-tail: calc(100% + var(--dimension-space-1) + var(--dimension-space-4));

  > :where(.moon-tooltip-content) {
    position: absolute;
    opacity: 0;
    width: max-content;
    max-width: var(--container-width-2xs);
    padding: var(--scale-sm-padding);
    color: var(--tooltip-text);
    border-radius: var(--scale-sm-radius);
    font: variables.$text-body-300;
    text-align: center;
    white-space: normal;
    transition:
      opacity 0.2s cubic-bezier(0.4, 0, 0.2, 1) 75ms,
      transform 0.2s cubic-bezier(0.4, 0, 0.2, 1) 75ms;
    background-color: var(--tt-bg);
    pointer-events: none;
    z-index: 1;
    --tw-content: attr(data-tip);
    content: var(--tw-content);
    transform: translateX(-50%) translateY(var(--tt-pos, var(--dimension-space-4)));
    inset: auto auto var(--tt-off) 50%;
  }

  &.moon-tooltip-pointer::after {
    position: absolute;
    opacity: 0;
    background-color: var(--tt-bg);
    transition:
      opacity 0.2s cubic-bezier(0.4, 0, 0.2, 1) 75ms,
      transform 0.2s cubic-bezier(0.4, 0, 0.2, 1) 75ms;
    content: "";
    pointer-events: none;
    width: var(--dimension-space-10);
    height: var(--dimension-space-4);
    display: block;
    position: absolute;
    mask-repeat: no-repeat;
    mask-position: calc(var(--dimension-space-1) * -1) 0;
    --mask-tooltip: url("data:image/svg+xml,%3Csvg width='10' height='4' viewBox='0 0 8 4' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0.500009 1C3.5 1 3.00001 4 5.00001 4C7 4 6.5 1 9.5 1C10 1 10 0.499897 10 0H0C-1.99338e-08 0.5 0 1 0.500009 1Z' fill='black'/%3E%3C/svg%3E%0A");
    mask-image: var(--mask-tooltip);
    transform: translateX(-50%) translateY(var(--tt-pos, var(--dimension-space-4)));
    inset: auto auto var(--tt-tail) 50%;
  }

  &.moon-tooltip-bottom {
    > :where(.moon-tooltip-content) {
      transform: translateX(-50%) translateY(var(--tt-pos, calc(var(--dimension-space-4) * -1)));
      inset: var(--tt-off) auto auto 50%;
    }

    &.moon-tooltip-pointer::after {
      transform: translateX(-50%) translateY(var(--tt-pos, calc(var(--dimension-space-4) * -1))) rotate(180deg);
      inset: var(--tt-tail) auto auto 50%;
    }
  }

  &.moon-tooltip-start {
    > :where(.moon-tooltip-content) {
      transform: translateX(calc(var(--tt-pos, var(--dimension-space-4)) - var(--dimension-space-4))) translateY(-50%);
      inset: 50% var(--tt-off) auto auto;
    }

    &.moon-tooltip-pointer::after {
      transform: translateX(var(--tt-pos, var(--dimension-space-4))) translateY(-50%) rotate(-90deg);
      inset: 50% calc(var(--tt-tail) + var(--dimension-space-1)) auto auto;
    }
  }

  &.moon-tooltip-end {
    > :where(.moon-tooltip-content) {
      transform: translateX(calc(var(--tt-pos, calc(var(--dimension-space-4) * -1)) + var(--dimension-space-4)))
        translateY(-50%);
      inset: 50% auto auto var(--tt-off);
    }

    &.moon-tooltip-pointer::after {
      transform: translateX(var(--tt-pos, calc(var(--dimension-space-4) * -1))) translateY(-50%) rotate(90deg);
      inset: 50% auto auto calc(var(--tt-tail) + var(--dimension-space-1));
    }
  }
}

.moon-tooltip {
  &.moon-tooltip-open,
  &[data-tip]:hover,
  &:hover,
  &:has(:focus-visible) {
    > :where(.moon-tooltip-content),
    &.moon-tooltip-pointer::after {
      opacity: 1;
      --tt-pos: 0rem;
      transition:
        opacity 0.2s cubic-bezier(0.4, 0, 0.2, 1) 0s,
        transform 0.2s cubic-bezier(0.4, 0, 0.2, 1) 0ms;
    }
  }
}
